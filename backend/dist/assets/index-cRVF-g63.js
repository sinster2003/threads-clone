import{j as e,r as p}from"./react-KGsOHu6s.js";import{c as We}from"./react-dom-PU-xc0gH.js";import{e as Ve,m as je,B as f,u as J,a as se,F as h,I as Z,b as V,T as te,c as v,d as S,V as He,f as u,A as T,g as j,M as Q,h as Y,P as Je,i as X,j as P,k as D,S as q,D as fe,l as A,H as be,n as M,o as E,p as B,q as qe,r as Ge,s as Ze,t as Ke,v as Qe,w as ne,x as re,y as oe,z as ie,C as ae,E as le,G as Ce,J as Ye,K as Xe,L as we,U as Pe,N as De,O as et,Q as pe,R as tt,W as st,X as nt}from"./@chakra-ui-S7gLMDVD.js";import{L as z,c as rt,R as ot}from"./react-router-dom-S7Lw3CNN.js";import{R as it,a as O,b as N,c as at,d as lt,e as ke,f as ct}from"./recoil-t79jA_X4.js";import{a as R}from"./axios-zw96FDk0.js";import{c as F,f as ce,O as dt}from"./react-router-81Y7PCx4.js";import{F as ht,a as gt,T as xt,B as mt,C as ut,M as Se,b as de,c as jt,d as pt}from"./react-icons-8xAYhA3H.js";import{f as yt}from"./date-fns-RkTpmM30.js";import{u as ve}from"./react-hook-form-S2Qtnlqs.js";import{o as Ie,s as W}from"./zod-P5efB973.js";import{t as Le}from"./@hookform-KJw2zjgt.js";import"./copy-to-clipboard-5-cIlDoe.js";import"./scheduler-iwWdm5Ml.js";import"./lodash.mergewith-aoqZodCs.js";import"./@emotion-rf6fpHqb.js";import"./hoist-non-react-statics-MGeNrgoW.js";import"./react-is-cHOZVpRJ.js";import"./@babel-8liIydx9.js";import"./stylis-UTZzoVRx.js";import"./color2k-kQY5sBkd.js";import"./framer-motion-3_rYQiA6.js";import"./react-focus-lock-6kFKjGRR.js";import"./focus-lock-ujctVxf5.js";import"./use-sidecar-qRtyEA_h.js";import"./tslib-gPgTONGq.js";import"./use-callback-ref-kI7Ebte7.js";import"./react-clientside-effect-TrQGyf8i.js";import"./react-remove-scroll-5L3jedDj.js";import"./react-remove-scroll-bar-bWTgz_Og.js";import"./react-style-singleton-mmVw_qMX.js";import"./get-nonce-ocLauj6V.js";import"./aria-hidden-dO-Fj-v0.js";import"./@popperjs-zyV4rJhQ.js";import"./react-fast-compare-8aGSg-5G.js";import"./@remix-run-y6mSg445.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();const ft={global:t=>({body:{color:je("gray.800","whiteAlpha.900")(t),bg:je("#ffffffe6","#14171c")(t)}})},bt={initialColorMode:"dark",useSystemColorMode:!0},Ct={gray:{light:"#616161",dark:"#1e1e1e"}},ye=Ve({styles:ft,config:bt,colors:Ct}),wt=({children:t})=>e.jsxs(e.Fragment,{children:[e.jsx(kt,{}),e.jsx(f,{minH:"70vh",children:t}),e.jsx(zt,{})]}),I=it({key:"userAtom",default:JSON.parse(localStorage.getItem("user"))}),kt=()=>{const{colorMode:t,toggleColorMode:s}=J(),r=O(I),a=F(),[n]=se("(max-width: 700px)");return e.jsxs(h,{mt:10,justifyContent:"center",alignItems:"center",position:"relative",children:[e.jsx(f,{position:"absolute",left:0,children:e.jsx(z,{to:"/",children:e.jsx(Z,{children:e.jsx(ht,{})})})}),e.jsx(V,{src:t==="dark"?"/light-logo.svg":"/dark-logo.svg",alt:"logo",onClick:s,cursor:"pointer",w:8}),r&&!n&&e.jsx(te,{hasArrow:!0,label:"profile",fontSize:"medium",children:e.jsx(Z,{position:"absolute",right:0,onClick:()=>a(`/${r==null?void 0:r.username}`),children:e.jsx(gt,{})})}),r&&n&&e.jsx(Me,{mobile:!0}),!r&&e.jsx(te,{hasArrow:!0,label:"login",fontSize:"medium",children:e.jsx(Z,{position:"absolute",right:0,onClick:()=>a("/login"),children:e.jsx(xt,{size:25})})})]})},St=async(t,s,r,a)=>{var n,i;try{a(!0);const l=await(await R.put(`/api/users/follow/${t}`,null,{withCredentials:!0})).data;localStorage.setItem("user",JSON.stringify(l==null?void 0:l.user)),r(l==null?void 0:l.user),s({title:`${l!=null&&l.status?"Followed":"Unfollowed"}`,description:l==null?void 0:l.message,status:"success",duration:3e3,isClosable:!0})}catch(c){s({title:"Error",description:(i=(n=c==null?void 0:c.response)==null?void 0:n.data)==null?void 0:i.error,status:"error",duration:3e3,isClosable:!0})}},vt=({userProfile:t,followersCount:s,setFollowersCount:r})=>{var x;const a=v(),[n,i]=N(I),[c,l]=p.useState(!1),o=(x=n==null?void 0:n.following)==null?void 0:x.includes(t._id),g=F();return e.jsx(S,{mb:-2,onClick:async()=>{if(await St(t._id,a,i,l),!n){g("/login");return}r(o?s-1:s+1),l(!1)},isLoading:c,children:o?"Unfollow":"Follow"})},It=({userProfile:t})=>{const s=v(),{colorMode:r}=J(),a=O(I),[n,i]=p.useState(0),{username:c}=ce();p.useEffect(()=>{var o;i((o=t==null?void 0:t.followers)==null?void 0:o.length)},[t]);const l=()=>{const o=window.location.href;navigator.clipboard.writeText(o).then(()=>{s({title:"Copied To Clipboard",description:"Use Ctrl + V to access the profile URL",status:"success",duration:5e3,isClosable:!0})})};return e.jsxs(He,{mt:"60px",alignItems:"start",spacing:3.5,children:[e.jsxs(h,{justifyContent:"space-between",w:"100%",children:[e.jsxs(f,{children:[e.jsx(u,{fontSize:"2xl",fontWeight:"bold",mb:1,children:t==null?void 0:t.name}),e.jsxs(h,{alignItems:"center",gap:3,children:[e.jsxs(u,{fontSize:"md",children:["@",t==null?void 0:t.username]}),e.jsx(u,{fontSize:"xs",w:20,textAlign:"center",color:r==="dark"?"gray.light":"gray.dark",bg:r==="dark"?"gray.dark":"gray.200",p:2,borderRadius:"full",children:"threads.net"})]})]}),e.jsx(f,{children:e.jsx(T,{name:t==null?void 0:t.name,src:t==null?void 0:t.profilePic,size:{base:"lg",md:"xl"}})})]}),e.jsx(u,{children:t==null?void 0:t.bio}),(t==null?void 0:t._id)!==(a==null?void 0:a._id)?e.jsx(vt,{userProfile:t,followersCount:n,setFollowersCount:i}):e.jsx(z,{to:"/update",children:e.jsx(S,{children:"Update Profile"})}),e.jsxs(h,{justifyContent:"space-between",alignItems:"center",w:"full",children:[e.jsxs(h,{alignItems:"center",gap:2,children:[e.jsxs(u,{color:"gray.light",children:[n," follower(s)"]}),e.jsx(f,{w:1,h:1,bg:"gray.light",borderRadius:"full"}),e.jsx(z,{to:`https://instagram.com/${c}/`,target:"_blank",children:e.jsx(u,{color:"gray.light",_hover:{textDecoration:"underline"},children:"instagram.com"})})]}),e.jsxs(h,{alignItems:"center",children:[e.jsx(f,{className:"icon-container",_hover:{bg:j("gray.100","#1e1e1e")},children:e.jsx(mt,{size:20})}),e.jsx(f,{className:"icon-container",_hover:{bg:j("gray.100","#1e1e1e")},children:e.jsxs(Q,{children:[e.jsx(Y,{children:e.jsx(ut,{size:20})}),e.jsx(Je,{children:e.jsx(X,{bg:j("gray.300","gray.dark"),children:e.jsx(P,{bg:j("gray.300","gray.dark"),onClick:l,children:"Copy Link"})})})]})})]})]}),e.jsxs(h,{justifyContent:"space-between",w:"full",children:[e.jsx(h,{flex:1,borderBottom:`1px solid ${r==="dark"?"white":"black"}`,color:r==="dark"?"whiteAlpha.900":"gray.dark",justifyContent:"center",alignItems:"center",children:e.jsx(u,{p:3,fontWeight:"bold",children:"Threads"})}),e.jsx(h,{flex:1,borderBottom:"1px solid gray",color:"gray.light",justifyContent:"center",alignItems:"center",children:e.jsx(u,{p:3,fontWeight:"bold",children:"Replies"})})]})]})},_e=async(t,s,r,a,n)=>{var i;try{if(!window.confirm("Are you want to delete this post?"))return;const l=await(await R.delete(`/api/posts/delete/${t}`,{withCredentials:!0})).data;if(l!=null&&l.error){console.log(l==null?void 0:l.error);return}let o=JSON.parse(localStorage.getItem("user"));o.posts=(i=o==null?void 0:o.posts)==null?void 0:i.filter(g=>g!==t),localStorage.setItem("user",JSON.stringify(o)),n(o),a({title:"Post deleted",description:l==null?void 0:l.message,status:"success",duration:3e3,isClosable:!0}),r(`/${s}`)}catch(c){console.log(c)}},he=at({key:"likesAtomFamily",default:lt({key:"likesAtomSelectorFamily",get:t=>async()=>{var s;try{return(s=(await(await R.get(`/api/posts/${t}`)).data).likes)==null?void 0:s.length}catch(r){throw console.log(r),r}}})}),Re=({post:t,userProfile:s,home:r})=>{var w,U,m,k,b,C,ee,H,ge,xe,me,ue;const a=v(),{colorMode:n}=J(),i=F(),{isOpen:c,onOpen:l,onClose:o}=D(),[g,x]=N(I),[y,d]=p.useState(!1),L=O(he(t._id)),_=$=>{console.log($),navigator.clipboard.writeText(`${window.location.origin}${$}`).then(()=>{a({title:"Copied post link",description:"use Ctrl + V to access the post link",status:"success",duration:5e3,isClosable:!0})})};return e.jsxs(f,{children:[e.jsx(z,{to:`/${s==null?void 0:s.username}/post/${t._id}`,children:e.jsxs(h,{mt:8,children:[e.jsxs(h,{flexDirection:"column",alignItems:"center",minW:{base:12,sm:20},children:[e.jsx(T,{name:s==null?void 0:s.name,size:"md",src:s==null?void 0:s.profilePic}),e.jsx(f,{h:"full",w:{base:.003,sm:.001},bg:"gray.500",my:6}),e.jsxs(h,{flexDirection:"row",flexWrap:"wrap",gap:1,alignItems:"center",justifyContent:"center",w:"80%",children:[((w=t.replies)==null?void 0:w.length)===0&&e.jsx(u,{children:"ðŸ¥±"}),((U=t.replies)==null?void 0:U[0])&&e.jsx(T,{name:"user1",h:{base:"14px",sm:"16px",md:"24px"},w:{base:"14px",sm:"16px",md:"24px"},src:`${(k=(m=t.replies)==null?void 0:m[0])==null?void 0:k.userProfilePic}`}),((b=t.replies)==null?void 0:b[1])&&e.jsx(T,{name:"user2",h:{base:"14px",sm:"16px",md:"24px"},w:{base:"14px",sm:"16px",md:"24px"},src:`${(ee=(C=t.replies)==null?void 0:C[1])==null?void 0:ee.userProfilePic}`}),((H=t.replies)==null?void 0:H[2])&&e.jsx(T,{name:"user3",h:{base:"14px",sm:"16px",md:"24px"},w:{base:"14px",sm:"16px",md:"24px"},src:`${(xe=(ge=t.replies)==null?void 0:ge[2])==null?void 0:xe.userProfilePic}`})]})]}),e.jsxs(h,{flexDirection:"column",ml:r?{base:3,md:3}:{base:2,md:6},mr:r&&{base:0,md:6},gap:4,w:"full",children:[e.jsxs(h,{justifyContent:"space-between",children:[e.jsxs(h,{alignItems:"center",gap:1,children:[e.jsx(u,{fontWeight:"bold",onClick:$=>{$.preventDefault(),i(`/${s==null?void 0:s.username}`)},children:s==null?void 0:s.username}),((me=s==null?void 0:s.followers)==null?void 0:me.length)>=25&&e.jsx(V,{src:"/verified.png",w:4,h:4})]}),e.jsxs(h,{alignItems:"center",gap:4,children:[e.jsx(Ae,{post:t}),(g==null?void 0:g._id)===(t==null?void 0:t.postedBy)&&e.jsx(f,{onClick:async $=>{$.preventDefault(),d(!0),await _e(t==null?void 0:t._id,g==null?void 0:g.username,i,a,x),d(!1)},children:y?e.jsx(q,{size:"xs"}):e.jsx(Se,{size:20})}),e.jsx(f,{onClick:$=>$.preventDefault(),children:e.jsxs(Q,{children:[e.jsx(Y,{bg:n==="dark"?"gray.dark":"gray.200",p:2,borderRadius:"50%",children:e.jsx(de,{})}),e.jsx(X,{bg:n==="dark"?"gray.dark":"gray.200",children:e.jsx(P,{bg:n==="dark"?"gray.dark":"gray.200",onClick:()=>_(`/${s==null?void 0:s.username}/post/${t._id}`),children:"Copy Post Link"})})]})})]})]}),e.jsxs(h,{flexDirection:"column",gap:4,children:[e.jsx(u,{fontSize:{base:"md",md:"lg"},children:t==null?void 0:t.text}),(t==null?void 0:t.img)&&e.jsx(V,{loading:"lazy",src:t==null?void 0:t.img,borderRadius:4,w:440})]}),e.jsx(Ue,{post:t,onOpen:l}),e.jsxs(h,{mb:8,gap:3,alignItems:"center",children:[e.jsxs(u,{color:"gray.light",children:[(ue=t==null?void 0:t.replies)==null?void 0:ue.length," replies"]}),e.jsx(f,{w:1,h:1,bg:"gray.light",borderRadius:"full"}),e.jsxs(u,{color:"gray.light",children:[L," likes"]})]})]})]})}),e.jsx($e,{post:t,userProfile:s,isOpen:c,onClose:o})]})},Ue=({post:t,onOpen:s})=>e.jsxs(h,{gap:4,pb:2,onClick:r=>r.preventDefault(),children:[e.jsx(Lt,{post:t}),e.jsx(_t,{onOpen:s}),e.jsx(Rt,{}),e.jsx(Ut,{})]}),Lt=({post:t})=>{var l;const s=O(I),r=ke(he(t._id)),[a,n]=p.useState((l=t==null?void 0:t.likes)==null?void 0:l.includes(s==null?void 0:s._id)),i=v();p.useEffect(()=>{var o;n((o=t==null?void 0:t.likes)==null?void 0:o.includes(s==null?void 0:s._id))},[t]);const c=async()=>{var o,g;try{const y=await(await R.put(`/api/posts/like/${t==null?void 0:t._id}`,null,{withCredentials:!0})).data;r(a?d=>d-1:d=>d+1),n(!a),i({title:`${y.message}`,status:"success",duration:3e3,isClosable:!0})}catch(x){i({title:"Error",description:(g=(o=x==null?void 0:x.response)==null?void 0:o.data)==null?void 0:g.error,status:"error",duration:3e3,isClosable:!0})}};return e.jsxs("svg",{"aria-label":"Like",color:a?"rgb(237, 73, 86)":j("rgba(0, 0, 0, 0.92)","white"),fill:a?"rgb(237, 73, 86)":"transparent",height:"19",role:"img",viewBox:"0 0 24 22",width:"20",onClick:c,cursor:"pointer",children:[e.jsx("title",{children:"Like"}),e.jsx("path",{d:"M1 7.66c0 4.575 3.899 9.086 9.987 12.934.338.203.74.406 1.013.406.283 0 .686-.203 1.013-.406C19.1 16.746 23 12.234 23 7.66 23 3.736 20.245 1 16.672 1 14.603 1 12.98 1.94 12 3.352 11.042 1.952 9.408 1 7.328 1 3.766 1 1 3.736 1 7.66Z",stroke:"currentColor",strokeWidth:"2"})]})},_t=({onOpen:t})=>{const s=O(I),r=v(),a=()=>{if(!s){r({title:"Please Login or signup",status:"error",duration:3e3,isClosable:!0});return}t()};return e.jsxs("svg",{"aria-label":"Comment",color:"",fill:"",height:"20",role:"img",viewBox:"0 0 24 24",width:"20",cursor:"pointer",onClick:a,children:[e.jsx("title",{children:"Comment"}),e.jsx("path",{d:"M20.656 17.008a9.993 9.993 0 1 0-3.59 3.615L22 22Z",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})]})},Rt=()=>e.jsxs("svg",{"aria-label":"Repost",color:"currentColor",fill:"currentColor",height:"20",role:"img",viewBox:"0 0 24 24",width:"20",cursor:"pointer",children:[e.jsx("title",{children:"Repost"}),e.jsx("path",{fill:"",d:"M19.998 9.497a1 1 0 0 0-1 1v4.228a3.274 3.274 0 0 1-3.27 3.27h-5.313l1.791-1.787a1 1 0 0 0-1.412-1.416L7.29 18.287a1.004 1.004 0 0 0-.294.707v.001c0 .023.012.042.013.065a.923.923 0 0 0 .281.643l3.502 3.504a1 1 0 0 0 1.414-1.414l-1.797-1.798h5.318a5.276 5.276 0 0 0 5.27-5.27v-4.228a1 1 0 0 0-1-1Zm-6.41-3.496-1.795 1.795a1 1 0 1 0 1.414 1.414l3.5-3.5a1.003 1.003 0 0 0 0-1.417l-3.5-3.5a1 1 0 0 0-1.414 1.414l1.794 1.794H8.27A5.277 5.277 0 0 0 3 9.271V13.5a1 1 0 0 0 2 0V9.271a3.275 3.275 0 0 1 3.271-3.27Z"})]}),Ut=()=>e.jsxs("svg",{"aria-label":"Share",color:"",fill:"rgb(243, 245, 247)",height:"20",role:"img",viewBox:"0 0 24 24",width:"20",cursor:"pointer",children:[e.jsx("title",{children:"Share"}),e.jsx("line",{fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2",x1:"22",x2:"9.218",y1:"3",y2:"10.083"}),e.jsx("polygon",{fill:"none",points:"11.698 20.334 22 3.001 2 3.001 9.218 10.084 11.698 20.334",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})]}),Bt=({postDetails:t,onOpen:s})=>{var y,d,L,_,w,U,m,k;const{colorMode:r}=J(),a=v(),[n,i]=N(I),c=F(),[l,o]=p.useState(!1),g=O(he(t._id)),x=()=>{const b=window.location.href;navigator.clipboard.writeText(b).then(()=>{a({title:"Copied post link",description:"use Ctrl + V to access the post link",status:"success",duration:5e3,isClosable:!0})})};return e.jsxs(h,{flexDirection:"column",gap:4,mt:"60px",children:[e.jsxs(h,{justifyContent:"space-between",mb:2,children:[e.jsxs(h,{alignItems:"center",gap:1,children:[e.jsx(T,{src:(y=t==null?void 0:t.postedBy)==null?void 0:y.profilePic,size:"md",mr:1.5,name:(d=t==null?void 0:t.postedBy)==null?void 0:d.name}),e.jsx(z,{to:`/${(L=t==null?void 0:t.postedBy)==null?void 0:L.username}`,children:e.jsx(u,{fontWeight:"bold",children:(_=t==null?void 0:t.postedBy)==null?void 0:_.username})})]}),e.jsxs(h,{alignItems:"center",gap:4,children:[e.jsx(Ae,{post:t}),(n==null?void 0:n._id)===((w=t==null?void 0:t.postedBy)==null?void 0:w._id)&&e.jsx(f,{onClick:async b=>{b.preventDefault(),o(!0),await _e(t==null?void 0:t._id,n==null?void 0:n.username,c,a,i),o(!1)},cursor:"pointer",children:l?e.jsx(q,{size:"xs"}):e.jsx(Se,{size:20})}),e.jsx(f,{onClick:b=>b.preventDefault(),children:e.jsxs(Q,{children:[e.jsx(Y,{bg:r==="dark"?"gray.dark":"gray.200",p:2,borderRadius:"50%",children:e.jsx(de,{})}),e.jsx(X,{bg:r==="dark"?"gray.dark":"gray.200",children:e.jsx(P,{bg:r==="dark"?"gray.dark":"gray.200",onClick:()=>x(),children:"Copy Post Link"})})]})})]})]}),e.jsxs(h,{flexDirection:"column",gap:4,children:[e.jsx(u,{fontSize:{base:"sm",md:"md"},children:t==null?void 0:t.text}),e.jsx(V,{loading:"lazy",src:t==null?void 0:t.img,w:550,borderRadius:4})]}),e.jsx(Ue,{post:t,onOpen:s}),e.jsxs(h,{gap:3,alignItems:"center",children:[e.jsxs(u,{color:"gray.light",children:[(U=t==null?void 0:t.replies)==null?void 0:U.length," replies"]}),e.jsx(f,{w:1,h:1,bg:"gray.light",borderRadius:"full"}),e.jsxs(u,{color:"gray.light",children:[g," likes"]})]}),e.jsx(fe,{}),e.jsxs(h,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs(h,{gap:4,alignItems:"center",children:[e.jsx(u,{fontSize:"2xl",children:"ðŸ‘‹"}),e.jsx(u,{color:"gray.light",children:"Get the app for like, reply and post"})]}),e.jsx(S,{children:"Get"})]}),e.jsx(u,{fontSize:"lg",fontWeight:"bold",mt:5,children:"Replies"}),((m=t==null?void 0:t.replies)==null?void 0:m.length)===0?e.jsx(u,{fontSize:"md",color:"gray.light",children:"No replies yet"}):(k=t==null?void 0:t.replies)==null?void 0:k.map((b,C)=>e.jsx(Tt,{comment:b==null?void 0:b.text,image:b==null?void 0:b.userProfilePic,username:b==null?void 0:b.username},C))]})},Ft=({comment:t,image:s,username:r})=>{const{colorMode:a}=J(),n=v(),i=c=>{navigator.clipboard.writeText(c).then(()=>{n({title:"Copied comment",description:"use Ctrl + V to access the comment content",status:"success",duration:5e3,isClosable:!0})})};return e.jsxs(h,{justifyContent:"space-between",mt:5,children:[e.jsxs(h,{alignItems:"start",gap:1,children:[e.jsx(T,{src:s,size:"sm",mr:1.5}),e.jsx(u,{fontSize:"sm",fontWeight:"bold",children:r})]}),e.jsxs(h,{alignItems:"center",gap:4,children:[e.jsx(u,{fontSize:"sm",color:"gray.light",children:"1d"}),e.jsx(f,{onClick:c=>c.preventDefault(),children:e.jsxs(Q,{children:[e.jsx(Y,{bg:a==="dark"?"gray.dark":"gray.200",p:1,fontSize:"xs",borderRadius:"50%",children:e.jsx(de,{})}),e.jsx(X,{bg:a==="dark"?"gray.dark":"gray.200",children:e.jsx(P,{bg:a==="dark"?"gray.dark":"gray.200",onClick:()=>i(t),children:"Copy Comment"})})]})})]})]})},Tt=({comment:t,image:s,username:r})=>e.jsxs(h,{flexDirection:"column",children:[e.jsx(fe,{}),e.jsx(Ft,{image:s,comment:t,username:r}),e.jsx(h,{flexDirection:"column",ml:10,children:e.jsx(u,{mb:3,fontSize:{base:"sm",lg:"md"},children:t})})]}),zt=()=>e.jsx(h,{justifyContent:"center",alignItems:"center",pt:10,pb:5,children:e.jsx(u,{color:j("gray.dark","gray.light"),children:"Copyrights Â© reserved at threads.net 2024"})}),Be=({text:t})=>e.jsx(A,{spacing:10,pt:4,children:e.jsx(S,{type:"submit",loadingText:"Submitting",bg:j("gray.600","gray.800"),color:"white",_hover:{bg:j("gray.700","gray.900")},children:t})}),Fe=({header:t,description:s})=>e.jsxs(h,{direction:"column",alignItems:"center",gap:4,children:[e.jsx(be,{children:t}),e.jsx(u,{fontSize:"lg",color:"gray.light",children:s})]}),Te=({ques:t,linkText:s,link:r})=>e.jsx(A,{pt:6,children:e.jsxs(u,{align:"center",children:[t," ",e.jsx(z,{to:r,children:e.jsx(u,{as:"span",display:"inline-block",color:"teal.400",children:s})})]})}),K=({label:t,type:s,width:r,register:a})=>e.jsx(f,{children:e.jsxs(M,{isRequired:!0,children:[e.jsx(E,{children:t}),e.jsx(B,{type:s,borderColor:j("gray.400"),variant:j("outline","filled"),focusBorderColor:j("gray.600","teal.400"),...a(t)})]})}),ze=({register:t})=>{const[s,r]=p.useState(!0);return e.jsx(f,{children:e.jsxs(M,{isRequired:!0,children:[e.jsx(E,{children:"Password"}),e.jsxs(qe,{children:[e.jsx(B,{type:s?"password":"text",borderColor:j("gray.400"),variant:j("outline","filled"),focusBorderColor:j("gray.600","teal.400"),...t("Password")}),e.jsx(Ge,{children:e.jsx(S,{variant:"ghost",onClick:()=>r(!s),children:s?e.jsx(Ze,{}):e.jsx(Ke,{})})})]})]})})},Oe=()=>{const[t,s]=p.useState(""),r=v();return{getFilesToRead:n=>{const i=n.target.files[0];if(i&&i.type.startsWith("image/")){const c=new FileReader;c.readAsDataURL(i),c.onloadend=()=>{s(c.result)}}else r({title:"Invalid File Type",description:"File Type must be an image",status:"error",isClosable:!0,duration:3e3}),s(null)},imgUrl:t,setImgUrl:s}},G=500,Ot=()=>{const[t,s]=p.useState(""),[r,a]=p.useState(G),{isOpen:n,onOpen:i,onClose:c}=D(),{getFilesToRead:l,imgUrl:o,setImgUrl:g}=Oe(),x=v(),y=p.useRef(null),[d,L]=N(I),_=F(),[w,U]=p.useState(!1),m=C=>{C.target.value.length>G?x({title:"Limit Reached",description:"Cannot exceed 500 characters",status:"error",duration:3e3,isClosable:!0}):(s(C.target.value),a(G-C.target.value.length))},k=()=>{c(),s(""),a(G),g(null),y.current.value=null},b=async()=>{try{U(!0);const C={postedBy:d._id,text:t,img:o||""},H=await(await R.post("/api/posts/create",C,{withCredentials:!0})).data;localStorage.setItem("user",JSON.stringify(H.user)),L(H.user),k(),U(!1),_(`/${d.username}`),x({title:"Posted successfully",description:"Creation of post successful",status:"success",duration:3e3,isClosable:!0})}catch(C){x({title:"Error",description:C==null?void 0:C.message,status:"error",duration:3e3,isClosable:!0})}};return e.jsxs(e.Fragment,{children:[e.jsx(S,{leftIcon:e.jsx(Qe,{}),position:"fixed",bottom:18,right:18,onClick:i,colorScheme:"twitter",variant:"solid",children:"Post"}),e.jsxs(ne,{isOpen:n,onClose:c,children:[e.jsx(re,{}),e.jsxs(oe,{children:[e.jsx(ie,{children:"Create Post"}),e.jsx(ae,{top:4}),e.jsxs(le,{children:[e.jsx(Ce,{placeholder:"Write your mind out...âœŒï¸",fontSize:"md",value:t,mb:3,onChange:m}),e.jsxs(u,{color:"whiteAlpha.800",children:[r," / 500"]}),e.jsxs(h,{mt:4,flexDirection:"column",children:[e.jsx(B,{type:"file",hidden:!0,ref:y,onChange:l}),e.jsx(Ye,{as:jt,cursor:"pointer",w:5,h:5,onClick:()=>{var C;return(C=y.current)==null?void 0:C.click()}}),o&&e.jsxs(h,{gap:2,flexDirection:"column",alignItems:"flex-end",children:[e.jsx(Xe,{onClick:()=>{g(null),y.current.value=null}}),e.jsx(V,{src:o,alt:"post-image",alignSelf:"center"})]})]})]}),e.jsxs(we,{children:[e.jsx(S,{colorScheme:"red",mr:3,onClick:k,isDisabled:w,children:"Cancel"}),e.jsx(S,{variant:"ghost",onClick:b,isLoading:w,children:"Create Post"})]})]})]})]})},$e=({post:t,userProfile:s,isOpen:r,onClose:a,setPostDetails:n})=>{const[i,c]=p.useState(""),[l,o]=p.useState(!1),g=v(),x=F(),y=async()=>{var d;try{o(!0);const _=await(await R.put(`/api/posts/reply/${t._id}`,{text:i},{withCredentials:!0})).data;n&&n({...t,replies:(d=t==null?void 0:t.replies)==null?void 0:d.concat({..._.reply})}),g({title:_.message,status:"success",duration:3e3,isClosable:!0}),c(""),a(),x(`/${(s==null?void 0:s.username)||s}/post/${t._id}`)}catch(L){console.log(L)}finally{o(!1)}};return e.jsxs(ne,{isOpen:r,onClose:a,children:[e.jsx(re,{}),e.jsxs(oe,{children:[e.jsx(ie,{children:"Express your thoughts"}),e.jsx(ae,{}),e.jsx(le,{children:e.jsx(Ce,{value:i,placeholder:"Express your feelings through your words",_placeholder:{color:"gray.light"},onChange:d=>c(d.target.value)})}),e.jsxs(we,{children:[e.jsx(S,{colorScheme:"red",mr:3,onClick:a,children:"Cancel"}),e.jsx(S,{variant:"ghost",isLoading:l,onClick:y,children:"Reply"})]})]})]})},Me=({mobile:t})=>{const s=ke(I),r=async()=>{var a,n;try{const i=await R.post("/api/users/logout");console.log(i.data.message),localStorage.removeItem("user"),s(null)}catch(i){console.log((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)}};return e.jsx(te,{hasArrow:!0,label:"logout",fontSize:"medium",children:e.jsx(Z,{position:"absolute",right:t?0:18,top:!t&&18,onClick:r,children:e.jsx(pt,{})})})},Ae=({post:t})=>{var s;return(s=Object.keys(t))!=null&&s.length?e.jsx(u,{color:"gray.light",fontSize:{base:"sm",md:"md"},children:yt(new Date(t==null?void 0:t.createdAt),{includeSeconds:!0,addSuffix:!0})}):null},$t=()=>{var l,o;const{username:t}=ce(),[s,r]=p.useState(null),a=O(I),n=v(),[i,c]=p.useState(!0);return p.useEffect(()=>{R.get(`/api/users/profile/${t}`).then(g=>g.data).then(g=>{r(g)}).catch(g=>{var x,y;n({title:"Error",description:((y=(x=g==null?void 0:g.response)==null?void 0:x.data)==null?void 0:y.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0}),r(null)}).finally(()=>c(!1))},[a,t]),i?e.jsx(h,{justifyContent:"center",alignItems:"center",my:10,children:e.jsx(q,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"gray.light",size:"xl"})}):s?e.jsxs(f,{w:"full",children:[!i&&s&&e.jsx(It,{userProfile:s}),((l=s==null?void 0:s.posts)==null?void 0:l.length)===0&&e.jsx(u,{color:"gray.light",fontSize:"lg",textAlign:"center",my:10,children:"No Posts Yet"}),(o=s==null?void 0:s.posts)==null?void 0:o.map(g=>e.jsx(Re,{post:g,userProfile:s},g._id))]}):e.jsx(h,{w:"full",justifyContent:"center",mt:10,children:e.jsx(z,{to:"/",children:e.jsx(S,{children:"Back to Safety"})})})},Mt=()=>{const{pid:t,username:s}=ce(),[r,a]=p.useState(null),{onOpen:n,isOpen:i,onClose:c}=D(),l=v();return p.useEffect(()=>{R.get(`http://localhost:3001/api/posts/${t}`).then(o=>o.data).then(o=>a(o)).catch(o=>{var g,x,y,d;l({title:`${((x=(g=o==null?void 0:o.response)==null?void 0:g.data)==null?void 0:x.error)||((d=(y=o==null?void 0:o.response)==null?void 0:y.data)==null?void 0:d.message)}`,status:"error",duration:3e3,isClosable:!0})})},[t]),r?e.jsxs(e.Fragment,{children:[e.jsx(Bt,{postDetails:r,onOpen:n}),e.jsx($e,{post:r,userProfile:s,isOpen:i,onClose:c,setPostDetails:a})]}):e.jsx(h,{justifyContent:"center",alignItems:"center",my:10,children:e.jsx(q,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"gray.light",size:"xl"})})},At=()=>{const t=O(I),s=F(),[r,a]=p.useState([]),[n,i]=p.useState(!0),[c,l]=p.useState(""),[o,g]=p.useState([]),[x,y]=p.useState(""),{isOpen:d,onOpen:L,onClose:_}=D(),[w]=se("(max-width: 700px)");p.useEffect(()=>{t||s("/login"),(async()=>{try{const b=await(await R.get("/api/posts/feed")).data;a(b)}catch(k){console.log(k)}finally{i(!1)}})()},[t]);const U=m=>{l(m.target.value),x&&clearTimeout(x);const k=setTimeout(async()=>{const C=await(await R.get(`/api/users/all?filter=${m.target.value}`)).data;g(C)},100);y(k)};return e.jsxs(h,{flexDirection:"column",justifyContent:"center",alignItems:"center",mt:10,w:"full",position:"relative",children:[e.jsxs(h,{gap:4,alignItems:"center",flexDirection:"column",children:[e.jsx(B,{value:c,placeholder:"Search for usernames & names",w:{base:300,md:400},onChange:U,onClick:L}),e.jsxs(ne,{isOpen:d,onClose:_,children:[e.jsx(re,{}),e.jsxs(oe,{children:[e.jsx(ae,{}),e.jsx(ie,{textAlign:"center",mt:10,children:e.jsx(B,{value:c,placeholder:"Search for usernames & names",w:{base:300,md:400},onChange:U})}),e.jsx(le,{children:(o==null?void 0:o.length)>0&&(o==null?void 0:o.length)<=5&&e.jsx(f,{w:"full",h:300,children:e.jsx(Pe,{listStyleType:"none",children:o==null?void 0:o.map(m=>{var k;return e.jsx(z,{to:`/${m==null?void 0:m.username}`,children:e.jsx(De,{my:4,children:e.jsxs(h,{alignItems:"center",gap:2,children:[e.jsx(T,{src:m==null?void 0:m.profilePic}),e.jsx(u,{children:m==null?void 0:m.username}),((k=m==null?void 0:m.followers)==null?void 0:k.length)>=25&&e.jsx(V,{src:"/verified.png",w:4,h:4})]})})},m==null?void 0:m._id)})})})})]})]})]}),w&&e.jsx(z,{to:`/${t==null?void 0:t.username}`,children:e.jsx(S,{my:4,fontSize:"sm",children:"Visit Profile"})}),n&&e.jsx(h,{justifyContent:"center",alignItems:"center",my:10,children:e.jsx(q,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"gray.light",size:"xl"})}),(!n&&(r==null?void 0:r.length))===0&&e.jsx(u,{color:"gray.light",fontSize:"lg",textAlign:"center",my:10,children:"Follow People To Light Your Feed UpðŸ¤—"}),e.jsx(f,{w:"full",children:!n&&(r==null?void 0:r.map(m=>e.jsx(Re,{post:m,userProfile:m.postedBy,home:"home"},m._id)))})]})},Ee=Ie({"Full Name":W(),Username:W().min(2),Email:W().email("Invalid Email"),Password:W().min(6)});Ee.required("Enter all the fields");const Et=()=>{const{register:t,handleSubmit:s,formState:{errors:r}}=ve({resolver:Le(Ee)}),a=v(),[n,i]=N(I),c=F();p.useEffect(()=>{n&&c("/"),Object.keys(r).length&&a({title:`Error in field ${Object.keys(r)[0]}`,description:`${Object.values(r)[0].message}`,status:"error",duration:3e3,isClosable:!0})},[r,n]);const l=async o=>{var x,y;console.log(o);const g={name:o["Full Name"],email:o.Email,username:o.Username,password:o.Password};try{const d=await R.post("/api/users/signup",g);localStorage.setItem("user",JSON.stringify(d.data)),i(d.data)}catch(d){a({title:"Error",description:`${(y=(x=d.response)==null?void 0:x.data)==null?void 0:y.message}`,status:"error",duration:3e3,isClosable:!0})}};return e.jsx(f,{w:"full",children:e.jsx("form",{onSubmit:s(l),children:e.jsxs(h,{w:"full",direction:"column",mt:10,gap:10,alignItems:"center",justifyContent:"center",children:[e.jsx(Fe,{header:"Sign Up",description:"to communicate and network âœŒï¸"}),e.jsxs(A,{direction:"column",children:[e.jsxs(et,{justifyContent:"space-between",children:[e.jsx(K,{label:"Full Name",type:"text",register:t}),e.jsx(K,{label:"Username",type:"text",register:t})]}),e.jsx(K,{label:"Email",register:t}),e.jsx(ze,{register:t}),e.jsx(Be,{text:"Sign up"}),e.jsx(Te,{ques:"Already a user?",linkText:"Login",link:"/login"})]})]})})})},Ne=Ie({Username:W().min(2),Password:W().min(6)});Ne.required("Enter all the fields");const Nt=()=>{const{register:t,handleSubmit:s,formState:{errors:r}}=ve({resolver:Le(Ne)}),a=v(),n=F(),[i,c]=N(I);p.useEffect(()=>{i&&n("/"),Object.keys(r).length&&a({title:`Error in field ${Object.keys(r)[0]}`,description:`${Object.values(r)[0].message}`,status:"error",duration:3e3,isClosable:!0})},[r,i]);const l=async o=>{var x,y;const g={username:o.Username,password:o.Password};try{const d=await R.post("/api/users/login",g);localStorage.setItem("user",JSON.stringify(d.data)),c(d.data)}catch(d){a({title:"Error",description:`${(y=(x=d.response)==null?void 0:x.data)==null?void 0:y.message}`,status:"error",duration:3e3,isClosable:!0})}};return e.jsx(f,{w:"full",children:e.jsx("form",{onSubmit:s(l),children:e.jsxs(h,{w:"full",direction:"column",mt:10,gap:10,alignItems:"center",justifyContent:"center",children:[e.jsx(Fe,{header:"Login",description:"Welcome to a new era of networking âœŒï¸"}),e.jsxs(A,{direction:"column",w:"80%",children:[e.jsx(K,{label:"Username",type:"text",register:t}),e.jsx(ze,{register:t}),e.jsx(Be,{text:"Login"}),e.jsx(Te,{ques:"Do not have an account?",linkText:"Signup",link:"/signup"})]})]})})})},Wt=()=>{const[t,s]=N(I),r=F(),a=v(),[n,i]=p.useState({name:t==null?void 0:t.name,username:t==null?void 0:t.username,bio:t==null?void 0:t.bio,email:t==null?void 0:t.email,password:""}),[c,l]=p.useState(!1);p.useEffect(()=>{t||r("/login")},[t]);const o=p.useRef(null),{getFilesToRead:g,imgUrl:x}=Oe(),y=async d=>{var L,_;d.preventDefault(),l(!0);try{const w={...n,profilePic:x},m=await(await R.put(`/api/users/update/${t._id}`,w,{withCredentials:!0})).data;localStorage.setItem("user",JSON.stringify(m)),s(m),a({title:"Use Profile Updated Successfully",description:"User profile updated",duration:3e3,isClosable:!0,status:"success"})}catch(w){a({title:(_=(L=w==null?void 0:w.response)==null?void 0:L.data)==null?void 0:_.error,duration:3e3,isClosable:!0,status:"error"})}finally{l(!1)}};return e.jsx(f,{w:"full",children:e.jsx("form",{onSubmit:y,children:e.jsx(h,{align:"center",justify:"center",children:e.jsxs(A,{spacing:7,w:"full",maxW:"md",bg:j("white","gray.900"),p:6,mt:"60px",children:[e.jsx(be,{lineHeight:1.1,fontSize:{base:"2xl",sm:"3xl"},children:"User Profile"}),e.jsx(M,{id:"userName",children:e.jsxs(A,{direction:"row",spacing:6,children:[e.jsx(pe,{children:e.jsx(T,{size:"xl",src:x||(t==null?void 0:t.profilePic),name:n==null?void 0:n.name})}),e.jsxs(pe,{w:"full",children:[e.jsx(S,{w:"full",onClick:()=>{var d;return(d=o.current)==null?void 0:d.click()},children:"Change Avatar"}),e.jsx(B,{type:"file",hidden:!0,ref:o,onChange:g})]})]})}),e.jsxs(A,{spacing:5,mb:5,children:[e.jsxs(M,{id:"fullname",children:[e.jsx(E,{children:"Full Name"}),e.jsx(B,{placeholder:"Full Name",_placeholder:{color:"gray.500"},type:"text",value:n==null?void 0:n.name,borderColor:j("gray.400"),variant:j("outline","filled"),focusBorderColor:j("gray.600","teal.400"),onChange:d=>i({...n,name:d.target.value})})]}),e.jsxs(M,{id:"userName",children:[e.jsx(E,{children:"Username"}),e.jsx(B,{placeholder:"UserName",_placeholder:{color:"gray.500"},type:"text",value:n==null?void 0:n.username,borderColor:j("gray.400"),variant:j("outline","filled"),focusBorderColor:j("gray.600","teal.400"),onChange:d=>i({...n,username:d.target.value})})]}),e.jsxs(M,{id:"email",children:[e.jsx(E,{children:"Email address"}),e.jsx(B,{placeholder:"your-email@example.com",_placeholder:{color:"gray.500"},type:"email",value:n==null?void 0:n.email,borderColor:j("gray.400"),variant:j("outline","filled"),focusBorderColor:j("gray.600","teal.400"),onChange:d=>i({...n,email:d.target.value})})]}),e.jsxs(M,{id:"bio",children:[e.jsx(E,{children:"Bio"}),e.jsx(B,{placeholder:"Bio",_placeholder:{color:"gray.500"},type:"text",value:n==null?void 0:n.bio,borderColor:j("gray.400"),variant:j("outline","filled"),focusBorderColor:j("gray.600","teal.400"),onChange:d=>i({...n,bio:d.target.value})})]}),e.jsxs(M,{id:"password",children:[e.jsx(E,{children:"Password"}),e.jsx(B,{placeholder:"password",_placeholder:{color:"gray.500"},type:"password",borderColor:j("gray.400"),variant:j("outline","filled"),focusBorderColor:j("gray.600","teal.400"),onChange:d=>i({...n,password:d.target.value})})]})]}),e.jsxs(A,{spacing:6,direction:"row",children:[e.jsx(S,{bg:"red.400",color:"white",w:"full",_hover:{bg:"red.500"},onClick:()=>r("/"),isDisabled:c,children:"Cancel"}),e.jsx(S,{type:"submit",isLoading:c,bg:j("gray.600","gray.800"),color:"white",w:"full",_hover:{bg:j("gray.700","gray.700")},children:"Submit"})]})]})})})})},Vt=()=>{const t=O(I),[s]=se("(max-width: 700px)");return e.jsxs(e.Fragment,{children:[t&&!s?e.jsx(Me,{}):null,e.jsx(tt,{minH:"100vh",maxW:{base:"md",sm:"lg",lg:"xl"},display:"flex",flexDirection:"column",justifyContent:"space-around",children:e.jsx(wt,{children:e.jsx(dt,{})})}),t?e.jsx(Ot,{}):null]})},Ht=rt([{path:"/",element:e.jsx(Vt,{}),children:[{path:"/",element:e.jsx(At,{})},{path:"/signup",element:e.jsx(Et,{})},{path:"/login",element:e.jsx(Nt,{})},{path:"/update",element:e.jsx(Wt,{})},{path:"/:username",element:e.jsx($t,{})},{path:"/:username/post/:pid",element:e.jsx(Mt,{})}]}]),Jt=()=>e.jsx(ot,{router:Ht});We.createRoot(document.getElementById("root")).render(e.jsx(ct,{children:e.jsxs(st,{theme:ye,children:[e.jsx(nt,{initialColorMode:ye.config.initialColorMode}),e.jsx(Jt,{})]})}));
